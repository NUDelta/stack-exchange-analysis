var _ = require("underscore");
var plotly = require('plotly')('y3sh', 'w9w6r6shwo');

var viewsUnderdogs = {
  0: 565611,
  1: 38450,
  2: 13618,
  3: 6743,
  4: 3913,
  5: 2448,
  6: 1699,
  7: 1194,
  8: 958,
  9: 648,
  10: 581,
  11: 443,
  12: 353,
  13: 279,
  14: 255,
  15: 231,
  16: 176,
  17: 168,
  18: 139,
  19: 118,
  20: 116,
  21: 83,
  22: 81,
  23: 70,
  24: 66,
  25: 76,
  26: 62,
  27: 36,
  28: 55,
  29: 38,
  30: 37,
  31: 25,
  32: 33,
  33: 25,
  34: 33,
  35: 26,
  36: 29,
  37: 24,
  38: 16,
  39: 18,
  40: 13,
  41: 9,
  42: 13,
  43: 11,
  44: 9,
  45: 10,
  46: 12,
  47: 7,
  48: 7,
  49: 10,
  50: 6,
  51: 12,
  52: 13,
  53: 4,
  54: 5,
  55: 6,
  56: 5,
  57: 4,
  58: 6,
  59: 3,
  60: 3,
  61: 4,
  62: 7,
  63: 5,
  64: 7,
  65: 3,
  66: 2,
  67: 3,
  68: 2,
  69: 2,
  70: 2,
  71: 2,
  72: 3,
  74: 2,
  75: 1,
  76: 3,
  77: 3,
  78: 3,
  79: 4,
  80: 3,
  81: 1,
  82: 1,
  83: 2,
  85: 1,
  86: 3,
  87: 3,
  88: 3,
  89: 2,
  90: 2,
  91: 1,
  92: 1,
  94: 3,
  96: 1,
  101: 1,
  104: 1,
  105: 1,
  106: 1,
  107: 2,
  113: 1,
  114: 4,
  119: 1,
  120: 2,
  122: 2,
  123: 1,
  125: 1,
  127: 1,
  128: 1,
  129: 2,
  132: 2,
  138: 1,
  139: 2,
  145: 1,
  146: 1,
  154: 1,
  157: 1,
  166: 3,
  168: 1,
  180: 1,
  182: 1,
  207: 1,
  209: 1,
  268: 1,
  337: 1,
  361: 1
};

var viewsPosts = {
  0: 7504839,
  1: 267230,
  2: 87286,
  3: 41665,
  4: 23837,
  5: 14920,
  6: 10256,
  7: 7347,
  8: 5490,
  9: 4061,
  10: 3367,
  11: 2610,
  12: 2134,
  13: 1817,
  14: 1503,
  15: 1283,
  16: 1139,
  17: 1015,
  18: 830,
  19: 739,
  20: 652,
  21: 551,
  22: 494,
  23: 451,
  24: 390,
  25: 375,
  26: 329,
  27: 239,
  28: 251,
  29: 217,
  30: 237,
  31: 188,
  32: 155,
  33: 154,
  34: 168,
  35: 148,
  36: 126,
  37: 126,
  38: 104,
  39: 107,
  40: 95,
  41: 89,
  42: 93,
  43: 82,
  44: 69,
  45: 69,
  46: 63,
  47: 60,
  48: 51,
  49: 57,
  50: 37,
  51: 44,
  52: 51,
  53: 41,
  54: 27,
  55: 46,
  56: 35,
  57: 42,
  58: 33,
  59: 24,
  60: 31,
  61: 31,
  62: 28,
  63: 22,
  64: 33,
  65: 18,
  66: 32,
  67: 26,
  68: 22,
  69: 19,
  70: 22,
  71: 21,
  72: 24,
  73: 8,
  74: 13,
  75: 8,
  76: 17,
  77: 13,
  78: 13,
  79: 13,
  80: 11,
  81: 8,
  82: 7,
  83: 12,
  84: 8,
  85: 8,
  86: 8,
  87: 11,
  88: 12,
  89: 13,
  90: 17,
  91: 7,
  92: 5,
  93: 6,
  94: 9,
  95: 5,
  96: 7,
  97: 4,
  98: 8,
  99: 2,
  100: 2,
  101: 8,
  102: 5,
  103: 3,
  104: 5,
  105: 3,
  106: 4,
  107: 9,
  108: 5,
  109: 3,
  110: 8,
  111: 1,
  112: 2,
  113: 5,
  114: 7,
  115: 4,
  116: 7,
  117: 9,
  118: 2,
  119: 3,
  120: 3,
  121: 2,
  122: 4,
  123: 4,
  124: 4,
  125: 2,
  126: 3,
  127: 3,
  128: 9,
  129: 4,
  130: 1,
  132: 8,
  133: 4,
  134: 5,
  135: 2,
  136: 2,
  137: 1,
  138: 2,
  139: 2,
  140: 1,
  141: 1,
  142: 2,
  144: 2,
  145: 2,
  146: 5,
  147: 1,
  148: 3,
  151: 4,
  153: 2,
  154: 2,
  155: 3,
  156: 2,
  157: 1,
  161: 1,
  162: 2,
  163: 1,
  165: 1,
  166: 4,
  168: 1,
  170: 2,
  172: 1,
  175: 1,
  176: 1,
  178: 1,
  179: 2,
  180: 1,
  182: 1,
  183: 3,
  186: 1,
  187: 1,
  191: 2,
  192: 1,
  193: 1,
  195: 2,
  199: 2,
  200: 2,
  201: 1,
  206: 1,
  207: 2,
  209: 1,
  210: 1,
  213: 1,
  218: 1,
  219: 1,
  223: 2,
  225: 1,
  226: 1,
  229: 1,
  239: 1,
  243: 1,
  245: 1,
  246: 1,
  250: 2,
  254: 1,
  256: 1,
  257: 1,
  263: 1,
  264: 1,
  268: 1,
  273: 1,
  274: 1,
  278: 1,
  280: 1,
  286: 1,
  288: 1,
  290: 1,
  294: 1,
  315: 1,
  337: 1,
  343: 1,
  361: 1,
  373: 1,
  395: 1,
  479: 1
};


var trace1 = {
  x: _(_.keys(viewsPosts)).map(function (p) {
    return p * 4000
  }),
  y: _(_.values(viewsPosts)).map(function (p) {
    return p * .08
  }),
  name: "All Questions",
  marker: {color: "rgb(55, 83, 109)"},
  type: "bar"
};
var trace2 = {
  x: _(_.keys(viewsUnderdogs)).map(function (p) {
    return p * 4000
  }),
  y: _.values(viewsUnderdogs),
  name: "Underdog Questions",
  marker: {color: "rgb(26, 118, 255)"},
  type: "bar"
};
var data = [trace1, trace2];
var layout = {
  title: "View Counts of Questions and Underdogs",
  xaxis: {
    title: "Views",
    tickfont: {
      size: 14,
      color: "rgb(107, 107, 107)"
    }
  },
  yaxis: {
    title: "Posts",
    titlefont: {
      size: 16,
      color: "rgb(107, 107, 107)"
    },
    tickfont: {
      size: 14,
      color: "rgb(107, 107, 107)"
    }
  },
  legend: {
    x: 0,
    y: 1.0,
    bgcolor: "rgba(255, 255, 255, 0)",
    bordercolor: "rgba(255, 255, 255, 0)"
  },
  barmode: "group",
  bargap: 0.15,
  bargroupgap: 0.1
};
var graph_options = {
  layout: layout,
  filename: "stackoverflow-post-underdog-viewcount-bar",
  fileopt: "overwrite"
}
plotly.plot(data, graph_options, function (err, msg) {
  console.log(msg);
});